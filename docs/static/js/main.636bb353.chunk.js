(this.webpackJsonpeasytype=this.webpackJsonpeasytype||[]).push([[0],{115:function(e,t,n){e.exports={headerWrapper:"Editor_headerWrapper__3UcXJ",header:"Editor_header__2OTLs",container:"Editor_container__1osQd"}},131:function(e,t,n){e.exports={svg:"Canvas_svg__BAvnD"}},132:function(e,t,n){e.exports={selectedNotation:"Notation_selectedNotation__sXzY1"}},149:function(e,t,n){},150:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(26),o=n.n(i),c=n(160),s=n(56),l=n(159),u=n(174),d=n(175),h=n(176),b=n(177),f=n(178),p=n(27),j=n(15),x=Object(j.f)({selectedNotationKey:null,lastSelectedNotationKey:null,shouldNotationBlurAfterClick:!0,tieSourceKey:null,helpDialogVisible:!1,configDialogVisible:!1,clipboardContent:null}),v=[],O=-1;function g(e,t){var n=new Set;function a(e){return"object"===typeof e&&null!==e&&![Promise,Map,Set,WeakMap,WeakSet].some((function(t){return e instanceof t}))}return function e(t,r){if(!a(t)||!a(r))return t===r;if(t===r)return!0;if(n.has(t)||n.has(r))return!1;n.add(t),n.add(r);var i=Object.keys(t),o=Object.keys(r);return i.length===o.length&&i.every((function(n){return e(t[n],r[n])}))}(e,t)}function y(e){var t=Math.min(Math.max(0,O+e),v.length-1);t!==O&&(O=t,Object.assign(Z,v[t]))}function m(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];e.apply(this,n);var r=Object(j.i)(Z);g(v[O],r)||(v[++O]=r,v.length=O+1,v.length>256&&v.splice(0,256-v.length))}function k(){var e,t;"function"===typeof(arguments.length<=0?void 0:arguments[0])?t=arguments.length<=0?void 0:arguments[0]:(e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1]);var n=[e,m.bind(this,t)];return void 0===e&&n.shift(),j.b.apply(this,n)}function C(e){var t=this;Object(j.h)((function(){m.call(t,e)}))}var S=j.b,w=(j.h,n(161)),N="0",I="\u2500",T="\u2502",_="(",E=")",H=[N,"1","2","3","4","5","6","7"];function W(e){return H.includes((null===e||void 0===e?void 0:e.note)||e)}function M(e){var t={type:"notation",key:"n_".concat(String(Math.random())),note:"0",octave:0,dotted:!1,underline:0,breakUnderline:!1,prefixSups:[],topDecorators:[],tieTo:null};return e&&Object.assign(t,e),t}function A(e){var t=JSON.parse(JSON.stringify(Object(j.i)(e)));return delete t.key,M(t)}var B=k((function(e){if(x.tieSourceKey){if(x.tieSourceKey===e.key)return void(x.tieSourceKey=null);var t=V(x.tieSourceKey),n=t.notation,a=t.paragraph;if(!n)return void(x.tieSourceKey=null);a.notations.includes(e)?W(e)?(n.tieTo=e.key,e.tieTo=n.key):w.a.warn("\u53ea\u5141\u8bb8\u5728\u97f3\u7b26\u4e0a\u6dfb\u52a0\u8fde\u97f3\u7ebf\uff01"):w.a.warn("\u53ea\u5141\u8bb8\u76f8\u540c\u6bb5\u843d\u7684\u97f3\u7b26\u76f8\u8fde\uff01"),x.tieSourceKey=null}}));function D(e){var t={type:"paragraph",key:"p_".concat(String(Math.random())),notations:[],alignJustify:null};return e&&Object.assign(t,e),t}function K(e){var t={type:"beatsp",key:"b_".concat(String(Math.random())),notations:[],showndata:[],alignJustify:null};return e&&Object.assign(t,e),t}function Y(){return D({notations:[M({note:"0"}),M({note:"0"}),M({note:"0"}),M({note:"0"}),M({note:T})]})}var F={version:3,canvasWidth:896,canvasHeight:1024,defaultFontSize:16,defaultSubFontSize:12,title:"\u7121\u6a19\u984c",tone:"C",marginHorizontal:64,marginTop:32,gapAfterTitle:16,gapAfterHeader:32,gapBetweenParagraph:32,gapBetweenNotation:16,beat:[4,4],speed:75,authors:["\u4f5a\u540d \u4f5c\u8a5e","EasyType \u88fd\u8b5c"],notations:[],showheaders:!0};function z(){return JSON.parse(JSON.stringify(F))}function P(){var e=z();return e.paragraphs=[Y()],e}function V(e){var t={};return(Z.paragraphs||[]).some((function(n,a){var r=(n.notations||[]).findIndex((function(t){return t.key===e}));return-1!==r&&(t.notation=n.notations[r],t.notationIndex=r,t.paragraph=n,t.paragraphIndex=a,!0)})),t}var X,L,J,R,U,G=S((function(e){e||(e=P()),x.lastSelectedNotationKey=x.selectedNotationKey=x.tieSourceKey=null,v.length=0,O=-1,Object(j.j)((function(){for(var t=0,n=Object.keys(Z);t<n.length;t++){var a=n[t];Object(j.g)(Z,a)}Object.assign(Z,e)}))})),$=Object(j.f)(P()),Q=r.a.createContext($),Z=$,q=n(19);function ee(e,t){return function(e){X||(X=document.createElement("canvas"),L=X.getContext("2d"),J=window.getComputedStyle(document.body).fontFamily),L.font="".concat(e||Z.defaultFontSize,"px ").concat(J)}(e),L.measureText(t).width}function te(e,t){return R||(R=document.createElementNS("http://www.w3.org/2000/svg","svg"),(U=document.createElementNS("http://www.w3.org/2000/svg","text")).style.visibility="hidden",R.appendChild(U),document.body.appendChild(R)),U.style.fontSize=e+"px",U.textContent=t,U.getBBox()}function ne(e){var t=(null===e||void 0===e?void 0:e.notations)||[];return t.some((function(e,n){return e.tieTo&&t.findIndex((function(t){return t.key===e.tieTo}))>n}))}var ae=Object(j.f)({get maxContentWidth(){return Math.max(Z.canvasWidth-2*Z.marginHorizontal,0)},get minTieHeight(){return 8},get maxTieHeight(){return 20},get maxTieBezierOffset(){return 25},get underlineStepOffsetY(){return 3},get underlineInitialOffsetY(){return this.xHeight/2-3},get octaveStepOffsetY(){return 5},get octaveInitialOffsetAbove(){return ae.xHeight/2+2},get octaveInitialOffsetBelow(){return ae.xHeight/2-2},get titleOffsetY(){return Z.marginTop+32+Z.gapAfterTitle},get headerOffsetY(){var e=2*this.xHeight,t=this.titleOffsetY,n=t+e,a=t+this.xHeight*Z.authors.length;return Math.max(t,n,a)+Z.gapAfterHeader},get baseFontData(){var e=te(Z.defaultFontSize,"x");return{xWidth:e.width,xHeight:e.height}},get baseSubFontData(){var e=te(Z.defaultSubFontSize,"x");return{xWidth:e.width,xHeight:e.height}},get xHeight(){return this.baseFontData.xHeight},get xWidth(){return this.baseFontData.xWidth},get subXHeight(){return this.baseSubFontData.xHeight},get subXWidth(){return this.baseSubFontData.xWidth}}),re=ee.bind(null,Z.defaultFontSize),ie=ee.bind(null,Z.defaultSubFontSize);function oe(e){var t=e.notations||[];if(0===t.length)return ae.xHeight;ne(e);var n=t.map((function(e){return function(e){var t,n,a,r,i=[0],o=ae.xHeight/2,c=-ae.xHeight/2;i.push(o,c);var s=0|e.octave,l=e.underline>0?ae.underlineInitialOffsetY+ae.underlineStepOffsetY*(0|e.underline):0;i.push(l);var u=e.octave>0?-ae.octaveInitialOffsetAbove:ae.octaveInitialOffsetBelow+l;a=s>0?u-5*Math.abs(s):s<0?u+5*Math.abs(s):0;i.push(a),r=(null===(t=e.prefixSups)||void 0===t?void 0:t.length)?ae.subXHeight-4:0,i.push(r);var d=0;e.octave>0&&(d=ae.octaveInitialOffsetAbove-ae.octaveStepOffsetY*e.octave);var h=d-ae.subXHeight*(0|(null===(n=e.topDecorators)||void 0===n?void 0:n.length))-2;i.push(h);var b=Math.max.apply(Math,i),f=Math.min.apply(Math,i);return b-f}(e)})),a=t.map((function(e){return le(e)})),r=n.map((function(e,t){return e-a[t]}));return 0+(Math.max.apply(Math,Object(q.a)(r))+Math.max.apply(Math,Object(q.a)(a)))}function ce(e){var t=e.notations||[];if(0===t.length)return ae.xHeight/2;return ne(e),t.map((function(e){return le(e)})).reduce((function(e,t){return Math.max(e,t)}),ae.xHeight/2)+0}function se(e){var t=e.prefixSups||[];return ie(t.join(""))+2*t.length}function le(e){var t,n=[0],a=ae.xHeight/2;n.push(a);var r=0;e.octave>0&&(r=ae.octaveInitialOffsetAbove+ae.octaveStepOffsetY*Math.abs(e.octave)),n.push(r);var i=r+ae.subXHeight*(0|(null===(t=e.topDecorators)||void 0===t?void 0:t.length))-2;return n.push(i),Math.max.apply(Math,n)}function ue(e){var t=re(e.note)+Z.gapBetweenNotation;return se(e)+t+(e.dotted?8:0)}var de=ae,he=n(163),be=n(164),fe=n(165),pe=n(166),je=n(167),xe=n(168),ve=n(137),Oe=n(138),ge=n(169),ye=n(133),me=n(162),ke={1:0,2:2,3:4,4:5,5:7,6:9,7:11},Ce={0:1,1:1,2:2,3:2,4:3,5:4,6:4,7:5,8:5,9:6,10:7,11:7},Se={"\u266d":-1,"\u266f":1},we={1:"\u266f",3:"\u266f",6:"\u266f",8:"\u266f",10:"\u266d"},Ne={C:0,D:2,E:4,F:5,G:7,A:9,B:11},Ie=k((function(e){e|=0,Z.paragraphs.forEach((function(t){t.notations.forEach((function(t){if(W(t)&&N!==((null===(a=t)||void 0===a?void 0:a.note)||a)){t.octave+=Math.trunc(e/12);var n=ke[t.note]+e%12+(t.prefixSups||[]).reduce((function(e,t){return e+(0|Se[t])}),0);n>=12?(t.octave+=1,n-=12):n<0&&(t.octave-=1,n+=12),t.note=String(Ce[n]),t.prefixSups=(t.prefixSups||[]).filter((function(e){return"\u266f"!==e&&"\u266d"!==e})),we[n]&&t.prefixSups.unshift(we[n])}var a}))}))})),Te=k((function(e){var t=-(Ne[e.split("").at(-1)]-Ne[Z.tone.split("").at(-1)]);(e.startsWith("\u266d")||Z.tone.startsWith("\u266f"))&&(t-=1),(e.startsWith("\u266f")||Z.tone.startsWith("\u266d"))&&(t+=1),Ie(t),Z.tone=e})),_e=n(59),Ee=n.n(_e),He=n(75),We=n(126),Me=n.n(We);function Ae(e){return new Promise((function(t,n){var a=new FileReader;a.readAsText(e,"utf8"),a.onloadend=function(){t(JSON.parse(a.result))}}))}function Be(){return(Be=Object(He.a)(Ee.a.mark((function e(t){var n;return Ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(t);case 2:if((n=e.sent).version<=3){e.next=6;break}return w.a.error("\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u683c\u5f0f\uff0c\u8bf7\u4f7f\u7528\u6700\u65b0\u7248\u672c"),e.abrupt("return");case 6:G(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function De(){var e=new Blob([JSON.stringify(Object(j.i)(Z))],{type:"application/json"}),t=document.createElement("a");t.download=(Z.title||"\u672a\u6807\u9898")+".json",t.href=URL.createObjectURL(e),t.click(),URL.revokeObjectURL(t.href)}var Ke=n(2),Ye=ye.a.SubMenu,Fe=S((function(e){!function(e){Be.apply(this,arguments)}(e.target.files[0])})),ze=S((function(){Me.a.toPng(document.getElementById("svg-data"),{bgcolor:"white"}).then((function(e){console.log("called");var t=document.createElement("a");t.download=(Z.title||"\u672a\u6807\u9898")+".png",t.href=e,t.click()}))})),Pe=k((function(e){switch(e.key){case"undo":y(-1);break;case"redo":y(1);break;case"reset-title":C((function(){Z.title="\u3010\u6b4c\u66f2\u540d\u7a31\u3011"}));break;case"reset-authors":Z.authors=["\u3010\u4f5c\u66f2\u8005\u3011  \u4f5c\u66f2","\u3010\u586b\u8a5e\u8005\u3011  \u586b\u8a5e","\u3010\u8a18\u8b5c\u8005\u3011  \u8a18\u8b5c"];break;case"show-header":Z.authors=["\u3010\u4f5c\u66f2\u8005\u3011  \u4f5c\u66f2","\u3010\u586b\u8a5e\u8005\u3011  \u586b\u8a5e","\u3010\u8a18\u8b5c\u8005\u3011  \u8a18\u8b5c"],Z.showheaders=!0;break;case"del-header":Z.authors=[],Z.showheaders=!1;break;case"add-paragraph":Z.paragraphs.push(Y());break;case"add-beatcfg":var t=[];l.a.info({title:"\u6dfb\u52a0\u6ed1\u97f3\u7b26\u865f(BETA)",content:Object(Ke.jsxs)(me.a.Group,{onChange:function(e){t=e},children:[Object(Ke.jsx)(me.a,{value:0,children:"\u8abf\u5b50"}),Object(Ke.jsx)(me.a,{value:1,children:"\u7bc0\u62cd"}),Object(Ke.jsx)(me.a,{value:2,children:"\u901f\u5ea6"})]}),onOk:function(){if(0==t.length)l.a.error({title:"\u932f\u8aa4",content:"\u6c92\u6709\u9078\u64c7\u6ed1\u97f3\u7b26\u865f"});else{var e=D({notations:[K({showndata:t})]});Z.paragraphs.push(e)}}})}})),Ve=k((function(e){x.shouldNotationBlurAfterClick&&x.selectedNotationKey&&(x.lastSelectedNotationKey=x.selectedNotationKey,x.selectedNotationKey=null),x.shouldNotationBlurAfterClick=!0}));var Xe=k((function(e){var t=e.key.toLowerCase(),n=e.shiftKey,a=e.ctrlKey;if(navigator.userAgent.includes("Mac OS X")&&(a=e.metaKey),x.selectedNotationKey){if(x.helpDialogVisible||x.configDialogVisible)return;var r=V(x.selectedNotationKey),i=r.paragraph,o=r.notation,c=r.paragraphIndex,s=r.notationIndex;if(!o)return;switch(!0){case W(t)&&!a&&!n:o.note=t;break;case"("===t&&!a:o.note=_;break;case")"===t&&!a:o.note=E;break;case"-"===t&&!a&&!n:o.note=I;break;case"|"===t&&!a:o.note=T;break;case"u"===t&&!a&&!n:o.underline+=1;break;case"u"===t&&!a&&n:o.underline-=1,o.underline=Math.max(0,o.underline);break;case"."===t&&!a&&!n:o.dotted=!o.dotted;break;case"8"===t&&!a&&!n:o.octave+=1;break;case"*"===t&&!a:o.octave-=1;break;case"#"===t&&!a:0!==o.prefixSups.indexOf("\u266f")?("\u266d"===o.prefixSups[0]&&o.prefixSups.shift(),o.prefixSups.unshift("\u266f")):o.prefixSups.shift();break;case"b"===t&&!a&&!n:0!==o.prefixSups.indexOf("\u266d")?("\u266f"===o.prefixSups[0]&&o.prefixSups.shift(),o.prefixSups.unshift("\u266d")):o.prefixSups.shift();break;case"a"===t&&!a&&!n:x.tieSourceKey?x.tieSourceKey===o.key?x.tieSourceKey=null:B(o):x.tieSourceKey=o.key;break;case"a"===t&&!a&&n:if(o.tieTo){var l=V(o.tieTo).notation;l&&(l.tieTo=null),o.tieTo=null;break}case"!"===t&&!a:o.breakUnderline=!o.breakUnderline;break;case"~"===t&&!a:o.topDecorators.includes("~")?o.topDecorators.splice(o.topDecorators.indexOf("~"),1):o.topDecorators.push("~");break;case"enter"===t&&!a&&!n:if(i.notations[s+1])x.selectedNotationKey=i.notations[s+1].key;else{var u=M();i.notations.push(u),x.selectedNotationKey=u.key}break;case"l"===t&&!a&&!n:var d,h=i.notations[s+1]||(null===(d=Z.paragraphs[c+1].notations)||void 0===d?void 0:d.at(0));h&&(x.selectedNotationKey=h.key);break;case"enter"===t&&!a&&n:i.notations[s-1]&&(x.selectedNotationKey=i.notations[s-1].key);break;case"h"===t&&!a&&!n:var b,f=i.notations[s-1]||(null===(b=Z.paragraphs[c-1].notations)||void 0===b?void 0:b.at(-1));f&&(x.selectedNotationKey=f.key);break;case"enter"===t&&a&&!n:var p=M();s===i.notations.length-1&&c===Z.paragraphs.length-1?(Z.paragraphs.push(D({notations:[p]})),x.selectedNotationKey=Z.paragraphs.at(-1).notations.at(0).key):(i.notations.splice(s+1,0,p),x.selectedNotationKey=p.key);break;case"j"===t&&!a&&!n:var v,O=Z.paragraphs[c+1];if(null===O||void 0===O||null===(v=O.notations)||void 0===v?void 0:v.length){var g=O.notations[s]||O.notations.at(-1);x.selectedNotationKey=g.key}break;case"k"===t&&!a&&!n:var m,k=Z.paragraphs[c-1];if(null===k||void 0===k||null===(m=k.notations)||void 0===m?void 0:m.length){var C=k.notations[s]||k.notations.at(-1);x.selectedNotationKey=C.key}break;case"backspace"===t&&!a&&!n:case"delete"===t&&!a&&!n:i.notations.splice(s,1);var S=i.notations[s]||i.notations[s-1];x.selectedNotationKey=null===S||void 0===S?void 0:S.key;break;case"backspace"===t&&!a&&n:case"delete"===t&&!a&&n:var w,N;Z.paragraphs.splice(c,1);var H=Z.paragraphs[c]||Z.paragraphs.at(-1),Y=(null===H||void 0===H||null===(w=H.notations)||void 0===w?void 0:w.at(s))||(null===H||void 0===H||null===(N=H.notations)||void 0===N?void 0:N.at(-1));x.selectedNotationKey=null===Y||void 0===Y?void 0:Y.key;break;case"="===t&&!a&&!n:"boolean"!==typeof i.alignJustify&&(i.alignJustify=!(c===Z.paragraphs.length-1)),i.alignJustify=!i.alignJustify;break;case"c"===t&&a&&!n:e.preventDefault(),x.clipboardContent=o;break;case"c"===t&&a&&n:e.preventDefault(),x.clipboardContent=i;break;case"v"===t&&a&&!n:if(e.preventDefault(),x.clipboardContent)switch(x.clipboardContent.type){case"notation":i.notations.splice(s+1,0,A(x.clipboardContent));break;case"paragraph":Z.paragraphs.splice(c+1,0,function(e){var t=JSON.parse(JSON.stringify(Object(j.i)(e)));return delete t.key,t.notations=e.notations.map((function(e){return A(e)})),D(t)}(x.clipboardContent));break;default:x.clipboardContent=null}}}else if(!0===["h","j","k","l"].includes(t)){var F,z,P,X,L=V(x.lastSelectedNotationKey).notation;x.selectedNotationKey=null===(F=L||(null===(z=Z.paragraphs)||void 0===z||null===(P=z.at(0))||void 0===P||null===(X=P.notations)||void 0===X?void 0:X.at(0)))||void 0===F?void 0:F.key}switch(!0){case"z"===t&&a&&!n:y(-1);break;case"y"===t&&a&&!n:case"z"===t&&a&&n:y(1);break;case"s"===t&&a&&!n:e.preventDefault(),De();break;case"o"===t&&a&&!n:e.preventDefault();var J=document.createElement("input");J.type="file",J.accept=".json",J.onchange=Fe,J.click();break;case"?"===t&&!a:x.helpDialogVisible?x.helpDialogVisible=!1:(x.configDialogVisible=!1,x.helpDialogVisible=!0);break;case"b"===t&&!n:var R=D({notations:[K({})]});Z.paragraphs.push(R)}})),Le=Object(Ke.jsxs)(ye.a,{children:[Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(he.a,{}),onClick:function(){G()},children:"\u65b0\u589e"},"create"),Object(Ke.jsxs)(ye.a.Item,{icon:Object(Ke.jsx)(be.a,{}),children:["\u958b\u555f",Object(Ke.jsx)("input",{onChange:Fe,accept:".json",type:"file",title:"",style:{opacity:0,cursor:"pointer",width:"100%",left:0,top:0,height:"100%",position:"absolute"}})]},"open"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(fe.a,{}),onClick:function(){De()},children:"\u5132\u5b58\u6587\u4ef6"},"save"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(fe.a,{}),onClick:ze,children:"\u5c0e\u51fa\u70ba\u5716\u7247"},"export")]}),Je=Object(Ke.jsxs)(ye.a,{onClick:Pe,children:[Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(pe.a,{}),children:"\u5fa9\u539f"},"undo"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(je.a,{}),children:"\u91cd\u505a"},"redo"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(xe.a,{}),children:"\u6dfb\u52a0\u6bb5\u843d"},"add-paragraph"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(xe.a,{}),children:"\u6dfb\u52a0\u6ed1\u97f3\u7b26\u865f (BETA)"},"add-beatcfg"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(ve.a,{}),children:"\u5c55\u793a\u6a19\u984c\u4fe1\u606f"},"show-header"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(Oe.a,{}),children:"\u96b1\u85cf\u6a19\u984c\u4fe1\u606f"},"del-header"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(ge.a,{}),children:"\u91cd\u8a2d\u6b4c\u66f2\u540d\u7a31"},"reset-title"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(ge.a,{}),children:"\u91cd\u8a2d\u4f5c\u8005\u4fe1\u606f"},"reset-authors")]}),Re=(ye.a,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,ye.a.Item,n(4)),Ue=n(8),Ge=n(131),$e=n.n(Ge),Qe=["children"];var Ze=Object(p.a)((function(e){var t=e.children,n=Object(Ue.a)(e,Qe);return Object(Ke.jsx)("div",{id:"svg-data",children:Object(Ke.jsx)("svg",Object(Re.a)(Object(Re.a)({id:"temp_svg",xmlns:"http://www.w3.org/2000/svg",className:$e.a.svg,width:Z.canvasWidth,height:Z.canvasHeight,onContextMenu:function(e){return e.preventDefault()}},n),{},{children:t}))})})),qe=n(157),et=n(158),tt=["propertyName"],nt=["propertyName","label"],at=Object(p.a)((function(e){var t=e.propertyName,n=Object(Ue.a)(e,tt),a=S((function(e){var n=0|Number(e.target.value);Z[t]=n}));return Object(Ke.jsx)(qe.a,Object(Re.a)({value:Z[t],onChange:a},n))}));function rt(e){var t=e.propertyName,n=e.label,a=Object(Ue.a)(e,nt);return Object(Ke.jsx)(et.a.Item,Object(Re.a)(Object(Re.a)({label:n},a),{},{children:Object(Ke.jsx)(at,{propertyName:t})}))}var it,ot=function(e){var t=e.visible,n=e.onVisibleChange,r=Object(a.useCallback)((function(){null===n||void 0===n||n.call(null,!1)}),[n]),i=S((function(){var e=z(),t=e.canvasWidth,n=e.canvasHeight,a=e.marginTop,r=e.marginHorizontal,i=e.gapBetweenParagraph,o=e.gapBetweenNotation;Object.assign(Z,{canvasWidth:t,canvasHeight:n,marginTop:a,marginHorizontal:r,gapBetweenParagraph:i,gapBetweenNotation:o})}));return Object(Ke.jsx)(l.a,{style:{top:20},visible:t,title:"\u8a2d\u7f6e",onCancel:r,footer:[Object(Ke.jsx)(s.a,{onClick:i,children:"\u91cd\u7f6e\u70ba\u9ed8\u8a8d\u8a2d\u7f6e"},"reset"),Object(Ke.jsx)(s.a,{type:"primary",onClick:r,children:"\u95dc\u9589"},"close")],children:Object(Ke.jsxs)(et.a,{labelAlign:"right",labelCol:{span:4},children:[Object(Ke.jsx)(et.a.Item,{label:"\u756b\u5e03\u5927\u5c0f",children:Object(Ke.jsxs)(qe.a.Group,{children:[Object(Ke.jsx)(at,{propertyName:"canvasWidth",style:{width:"45%",textAlign:"center"}}),Object(Ke.jsx)(qe.a,{className:"site-input-split",style:{width:"10%",borderLeft:0,borderRight:0,textAlign:"center",pointerEvents:"none"},placeholder:"x",disabled:!0}),Object(Ke.jsx)(at,{propertyName:"canvasHeight",style:{width:"45%",textAlign:"center"}})]})}),Object(Ke.jsx)(rt,{label:"\u9802\u90e8\u908a\u8ddd",propertyName:"marginTop"}),Object(Ke.jsx)(rt,{label:"\u5de6\u53f3\u908a\u8ddd",propertyName:"marginHorizontal"}),Object(Ke.jsx)(rt,{label:"\u6bb5\u9593\u8ddd",propertyName:"gapBetweenParagraph"}),Object(Ke.jsx)(rt,{label:"\u97f3\u7b26\u9593\u8ddd",propertyName:"gapBetweenNotation"})]})})},ct=n(3),st=n(90),lt=n.n(st),ut=!1,dt={x:0,y:0};function ht(){return it||((it=document.createElement("div")).id="svg-popover-container",it.style="\n      position: absolute;\n      left: 0;\n      top: 0;\n    ",document.body.appendChild(it),document.addEventListener("scroll",(function(){ut=!0}))),it}function bt(){if(ut){var e=ht().getBoundingClientRect();dt={x:-e.x,y:-e.y},ut=!1}return dt}function ft(e){var t=e.children,n=e.renderContent,r=e.renderPopover,o=e.darkMode,c=e.globalClassName,s=e.offset,l=e.placement,u=e.style,d=e.title,h=e.trigger,b=e.visible,f=e.autoHide,p=e.showArrow,j=e.onVisibilityChange,x=Object(a.useRef)({x:0,y:0,width:0,height:0,top:0,bottom:0,left:0,right:0}),v=Object(a.useRef)(!1),O=Object(a.useRef)(),g=Object(a.useRef)(),y=Object(a.useState)(!1),m=Object(ct.a)(y,2),k=m[0],C=m[1],S=Object(a.useState)({x:0,y:0}),w=Object(ct.a)(S,2),N=w[0],I=w[1],T=Object(a.useState)(),_=Object(ct.a)(T,2)[1],E=[lt.a.popover,c].filter(Boolean),H=[lt.a.arrow],W=[lt.a.header],M=s&&s.x||0,A=s&&s.y||0,B={transform:""},D={};l=l.toLowerCase();var K=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;M+=e,A+=t},Y=Object(a.useCallback)((function(e){var t;e=null!==(t=e)&&void 0!==t?t:!k;var n=void 0===b?e:b;if(n){if(!O.current)return void setTimeout(Y,0);x.current=O.current.getBoundingClientRect()}C(n),j&&j(e)}),[b,k,j]),F=Object(a.useCallback)((function(e){I({x:e.pageX,y:e.pageY}),e.preventDefault(),Y(!0)}),[Y]);if(Object(a.useEffect)((function(){v.current=!0}),[]),Object(a.useEffect)((function(){if(!1!==f){var e=function(e){if("keydown"===e.type&&"Escape"===e.key)Y(!1);else if("mouseup"===e.type){for(var t=e.target;t;t=t.parentElement){if(t===g.current)return;if(t===O.current){if("context"===h&&2!==e.button)continue;if("click"===h&&0!==e.button)continue;return}}Y(!1)}};return k&&(document.addEventListener("mouseup",e),document.addEventListener("keydown",e)),function(){document.removeEventListener("mouseup",e),document.removeEventListener("keydown",e)}}}),[k,f,Y,h]),void 0!==b&&b!==k&&(v.current?Y():setTimeout((function(){_([])}),0)),"context"!==h){var z=x.current;switch(!0){case/^(left|right)(top|center|bottom)?$/i.test(l):B.minHeight="32px",l.startsWith("right")?B.left=z.right+"px":(B.left=z.left+"px",B.transform+=" translate(-100%, 0)"),l.endsWith("top")?(B.top=z.top+"px",B.transform+=" translate(0, 0)",D.top="16px"):l.endsWith("bottom")?(B.top=z.bottom+"px",B.transform+=" translate(0, -100%)",D.bottom="0"):(B.top=z.y+z.height/2+"px",B.transform+=" translate(0, -50%)",D.top="50%");break;case/^(top|bottom)(left|center|right)?$/i.test(l):default:l.startsWith("bottom")?B.top=z.bottom+"px":(B.top=z.y+"px",B.transform+=" translate(0, -100%)"),l.endsWith("left")?(B.left=z.left+"px",D.left="16px"):l.endsWith("right")?(B.left=z.right+"px",B.transform+=" translate(-100%, 0)",D.right="0"):(B.left=z.right-z.width/2+"px",B.transform+=" translateX(0%)",D.left="50%")}switch(!0){case!p:break;case l.startsWith("left"):K(-8),H.push("left");break;case l.startsWith("right"):K(8),H.push("right");break;case l.startsWith("bottom"):K(0,8),H.push("bottom");break;case l.startsWith("top"):default:K(0,-8),H.push("top")}K(bt().x,bt().y),B.transform+=" translate(".concat(M,"px, ").concat(A,"px)")}else B.left=N.x,B.top=N.y,B.transform="translate(".concat(M,"px, ").concat(A,"px)");return o&&(E.push("dark"),H.push("dark"),W.push("dark")),B=Object.assign(B,u),Object(Ke.jsxs)(Ke.Fragment,{children:["[]",Object(Ke.jsx)("g",{type:"noop",ref:O,onClick:"click"===h?function(){return Y()}:void 0,onMouseEnter:"hover"===h?function(){return Y(!0)}:void 0,onMouseLeave:"hover"===h?function(){return Y(!1)}:void 0,onContextMenu:"context"===h?F:void 0,children:t}),k&&Object(i.createPortal)(Object(Ke.jsx)("div",{ref:g,className:E.join(" "),style:B,children:r?"function"===typeof r?r():r:Object(Ke.jsxs)(Ke.Fragment,{children:[p&&Object(Ke.jsx)("div",{className:H.join(" "),style:D}),d&&Object(Ke.jsx)("header",{className:W.join(" "),children:d}),Object(Ke.jsx)("div",{className:d?lt.a.content:null,children:"function"===typeof n?n():null!==n&&void 0!==n?n:null})]})}),ht())]})}ft.defaultProps={trigger:"click",placement:"top",showArrow:!0};var pt=r.a.memo(ft),jt=n(91),xt=n.n(jt),vt=function(e,t){var n=e.children,r=e.title,i=e.initialValue,o=e.inputType,c=e.options,l=e.overlay,u=e.onChange,d=e.popoverProps,h=Object(a.useState)(i),b=Object(ct.a)(h,2),f=b[0],p=b[1],j=Object(a.useState)(!1),x=Object(ct.a)(j,2),v=x[0],O=x[1];Object(a.useImperativeHandle)(t,(function(){return{showPopover:O.bind(null,!0),hidePopover:O.bind(null,!1)}}),[]);var g,y=Object(a.useCallback)((function(e){O(e),e||p(i)}),[i]),m=Object(a.useCallback)((function(e){p(e.target.value)}),[]),k=Object(a.useCallback)(function(){var e=Object(He.a)(Ee.a.mark((function e(t){var n;return Ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0===t?f:t,e.next=3,u&&u(n);case 3:!1!==e.sent&&O(!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[f,u]),C=Object(a.useCallback)((function(){O(!1)}),[]),S=Object(a.useCallback)((function(){p(i),O(!1)}),[i]),w=Object(a.useCallback)((function(){return Object(Ke.jsxs)(Ke.Fragment,{children:[Object(Ke.jsx)(qe.a,{autoFocus:!0,value:f,onChange:m,onPressEnter:function(){return k()}}),Object(Ke.jsxs)("div",{className:xt.a.buttonGroup,children:[Object(Ke.jsx)(s.a,{type:"primary",className:xt.a.button,onClick:function(){return k()},children:"\u78ba\u5b9a"}),Object(Ke.jsx)(s.a,{onClick:S,children:"\u53d6\u6d88"})]})]})}),[f,m,k,S]),N=Object(a.useCallback)((function(){return l?Object(Ke.jsx)("div",{onClick:C,children:l}):Object(Ke.jsx)(ye.a,{className:xt.a.menu,children:(c||[]).filter((function(e){return!1!==e.visible})).map((function(e){return Object(Ke.jsx)(ye.a.Item,{icon:e.icon,className:xt.a.menuItem+(e.key===i?" selected":""),onClick:function(){return k(e.key)},children:e.text},e.key)}))})}),[i,c,k,C,l]);if("select"===o)g=N;else g=w;return Object(Ke.jsx)(Ke.Fragment,{children:Object(Ke.jsx)(pt,Object(Re.a)(Object(Re.a)({trigger:"select"===o?"context":"click",title:r,renderContent:g,renderPopover:undefined,visible:v,placement:"bottom",onVisibilityChange:y},d),{},{children:n}))})},Ot=r.a.forwardRef(vt),gt=["children","type","editable","offset","offsetX","offsetY"];function yt(e){var t,n,a=e.children,r=e.type,i=e.editable,o=e.offset,c=e.offsetX,s=e.offsetY,l=Object(Ue.a)(e,gt);return c=0|(null!==(t=null===o||void 0===o?void 0:o.x)&&void 0!==t?t:c),s=0|(null!==(n=null===o||void 0===o?void 0:o.y)&&void 0!==n?n:s),Object(Ke.jsx)("g",Object(Re.a)(Object(Re.a)({type:r,transform:"translate(".concat(c,",").concat(s,")"),style:i?{cursor:"pointer"}:null},l),{},{children:a}))}function mt(e){var t=document.createElement("span");return t.appendChild(document.createTextNode(e)),t.innerHTML.replace(/\s/g," ")}var kt=["children","editable"];function Ct(e){var t=e.children,n=e.editable,a=Object(Ue.a)(e,kt);return"string"===typeof t?Object(Ke.jsx)("text",Object(Re.a)({x:"0",y:"0",style:n?{cursor:"pointer"}:null,dominantBaseline:"hanging",stroke:"none",fontWeight:"bold",fill:"currentColor",dangerouslySetInnerHTML:{__html:mt(t)}},a)):Object(Ke.jsx)("text",Object(Re.a)(Object(Re.a)({x:"0",y:"0",style:n?{cursor:"pointer"}:null,dominantBaseline:"hanging",stroke:"none",fontWeight:"bold",fill:"currentColor"},a),{},{children:t}))}var St=["C","D","E","F","G","A","B","\u266dC","\u266dD","\u266dE","\u266dF","\u266dG","\u266dA","\u266dB"].map((function(e){return{key:e,text:e}})),wt=k((function(e){Z.tone=e})),Nt=k((function(e){Z.speed=e})),It=k((function(e){var t=String(e).split("/");if(2!==t.length)return w.a.error("\u8acb\u4ee5\u3010*/*\u3011\u7684\u683c\u5f0f\u8f38\u5165\u7bc0\u62cd\uff01"),!1;var n=[parseInt(t[0],10),parseInt(t[1],10)],a=n[0],r=n[1];if(!(a>0&&r>0))return w.a.error("\u8acb\u8f38\u5165\u5927\u65bc0\u7684\u62cd\u6578\u548c\u6642\u503c\uff01"),!1;Z.beat=[a,r]}));var Tt=Object(p.a)((function(){return Z.showheaders?Object(Ke.jsxs)(Ke.Fragment,{children:[Object(Ke.jsx)(Ot,{inputType:"select",initialValue:Z.tone,options:St,onChange:wt,popoverProps:{trigger:"click"},children:Object(Ke.jsxs)(yt,{type:"tone",editable:!0,offsetX:Z.marginHorizontal,offsetY:de.titleOffsetY,children:[Object(Ke.jsx)(Ct,{children:"1 = "}),Z.tone.startsWith("\u266d")&&Object(Ke.jsx)(Ct,{x:"27",y:"-2",fontSize:Z.defaultSubFontSize,children:"\u266d"}),Object(Ke.jsx)(Ct,{editable:!0,x:Z.tone.startsWith("\u266d")?36:29,children:Z.tone.at(-1)})]})}),Object(Ke.jsx)(Ot,{title:"\u7bc0\u62cd\uff1a",inputType:"number",initialValue:Z.beat.join("/"),onChange:It,children:Object(Ke.jsxs)(yt,{type:"beat",editable:!0,offsetX:Z.marginHorizontal+64,offsetY:de.titleOffsetY,children:[Object(Ke.jsx)(Ct,{x:"0",y:"-8",textAnchor:"middle",children:Z.beat[0]}),Object(Ke.jsx)(Ct,{x:"0",y:"12",textAnchor:"middle",children:Z.beat[1]}),Object(Ke.jsx)("line",{x1:"-8",y1:"8",x2:"8",y2:"8",stroke:"currentColor"})]})}),Object(Ke.jsx)(Ot,{title:"\u901f\u5ea6\uff08bps\uff09\uff1a",inputType:"number",initialValue:Z.speed,onChange:Nt,children:Object(Ke.jsxs)(yt,{editable:!0,type:"speed",offsetX:Z.marginHorizontal,offsetY:de.titleOffsetY+22,children:[Object(Ke.jsx)(Ct,{x:"2",children:"\u2669"}),Object(Ke.jsxs)(Ct,{x:"16",children:["= ",Z.speed]})]})})]}):Object(Ke.jsx)(Ke.Fragment,{})})),_t=n(170),Et=[{key:"create",text:"\u6dfb\u52a0",icon:Object(Ke.jsx)(he.a,{}),onClick:function(){Z.authors.push("\u4f5c\u8005\u4fe1\u606f")}},{key:"delete",text:"\u522a\u9664",icon:Object(Ke.jsx)(_t.a,{}),onClick:function(e){Z.authors.splice(e,1)}},{key:"deleteall",text:"\u522a\u9664\u6240\u6709",icon:Object(Ke.jsx)(_t.a,{}),onClick:function(e){Z.authors=[]}}],Ht=[{key:"create",text:"\u6dfb\u52a0\u4f5c\u8005\u4fe1\u606f",icon:Object(Ke.jsx)(he.a,{}),onClick:function(){Z.authors.push("\u3010\u8a18\u8b5c\u8005\u3011  \u8a18\u8b5c")}}],Wt=k((function(e,t){var n=Et.find((function(e){return e.key===t}));null===n||void 0===n||n.onClick(e)})),Mt=k((function(e){var t=Ht.find((function(t){return t.key===e}));null===t||void 0===t||t.onClick()})),At=k((function(e,t){if(!t)return new Promise((function(t){l.a.confirm({title:"\u4f60\u60f3\u522a\u9664\u9019\u500b\u4f5c\u8005\u4fe1\u606f\u55ce\uff1f",okText:"\u522a\u9664",cancelText:"\u53d6\u6d88",onOk:function(){t(!0),Z.authors.splice(e,1)},onCancel:function(){t(!0)}})}));Z.authors[e]=t}));var Bt=Object(p.a)((function(){return Object(Ke.jsxs)(yt,{type:"authors",offsetX:Z.canvasWidth-Z.marginHorizontal,offsetY:de.titleOffsetY,children:[Object(Ke.jsx)(Ot,{inputType:"select",options:Ht,popoverProps:{trigger:"context"},onChange:Mt,children:Object(Ke.jsx)("rect",{x:Z.marginHorizontal-150,y:"-64",width:150,height:150,fill:Z.authors.length?"none":"transparent"})}),Z.authors.map((function(e,t){return Object(Ke.jsx)(Ot,{inputType:"select",options:Et,popoverProps:{trigger:"context"},onChange:Wt.bind(null,t),children:Object(Ke.jsx)(Ot,{title:"\u4f5c\u8005\u4fe1\u606f\uff1a",initialValue:e,onChange:At.bind(null,t),children:Object(Ke.jsx)(Ct,{editable:!0,y:22*t,textAnchor:"end",children:e})})},t+e)}))]})})),Dt=k((function(e){Z.title=e}));var Kt=Object(p.a)((function(){var e=Object(a.useRef)();return Object(Ke.jsx)(yt,{type:"title",offsetY:Z.marginTop,children:Object(Ke.jsx)(Ot,{ref:e,title:"\u6b4c\u66f2\u540d\u7a31\uff1a",initialValue:Z.title,onChange:Dt,children:Object(Ke.jsx)(Ct,{editable:!0,x:"50%",fontSize:"32",fill:"currentColor",stroke:"none",textAnchor:"middle",children:Z.title})})})})),Yt=k((function(e){Z.page=e}));var Ft=Object(p.a)((function(){var e=Object(a.useRef)();return Object(Ke.jsx)(yt,{type:"pageno",offsetY:Z.canvasHeight-40,children:Object(Ke.jsx)(Ot,{ref:e,title:"\u9801\u78bc",initialValue:Z.page,onChange:Yt,children:Object(Ke.jsx)(Ct,{editable:!0,x:"50%",fontSize:"14",fill:"currentColor",textAnchor:"middle",children:Z.page})})})}));var zt=Object(p.a)((function(){return Object(Ke.jsxs)(Ke.Fragment,{children:[Object(Ke.jsx)(Kt,{}),Z.showheaders&&Object(Ke.jsx)(Tt,{}),Object(Ke.jsx)(Bt,{}),Object(Ke.jsx)(Ft,{})]})})),Pt=n(60),Vt=n.n(Pt);function Xt(e){var t=e.kbd,n=e.desc;return Object(Ke.jsxs)("li",{className:Vt.a.listItem,children:[Object(Ke.jsx)("kbd",{className:Vt.a.kbd,style:{fontFamily:"Consolas"},children:t}),Object(Ke.jsx)("span",{children:n})]})}var Lt=function(e){var t=e.visible,n=e.onVisibleChange,r="Ctrl";navigator.userAgent.includes("Mac OS X")&&(r="\u2318");var i=Object(a.useCallback)((function(){null===n||void 0===n||n.call(null,!1)}),[n]);return Object(Ke.jsxs)(l.a,{width:"100%",height:"90%",style:{top:"4%"},visible:t,title:"\u5feb\u6377\u9375",onCancel:i,footer:Object(Ke.jsx)(s.a,{type:"primary",onClick:i,children:"\u78ba\u8a8d"},"close"),children:[Object(Ke.jsx)("h3",{children:"\u5168\u5c40"}),Object(Ke.jsxs)("ul",{className:Vt.a.list,children:[Object(Ke.jsx)(Xt,{kbd:"?",desc:"\u986f\u793a\u6b64\u9801\u9762"}),Object(Ke.jsx)(Xt,{kbd:r+"+Z",desc:"\u5fa9\u539f"}),Object(Ke.jsx)(Xt,{kbd:r+"+Shift+Z",desc:"\u91cd\u505a"}),Object(Ke.jsx)(Xt,{kbd:r+"+O",desc:"\u958b\u555f"}),Object(Ke.jsx)(Xt,{kbd:"h j k l",desc:"\u79fb\u52d5\u7126\u9ede"})]}),Object(Ke.jsx)("h3",{children:"\u53ea\u9078\u4e2d\u7b26\u865f\u6642"}),Object(Ke.jsx)("h4",{children:"\u8f38\u5165\u97f3\u7b26"}),"\u76f4\u63a5\u6309\u9375\u76e4\u4e0a\u76f8\u61c9\u7684\u6309\u9375\u5373\u53ef\u8f38\u5165\u5230\u7576\u524d\u7b26\u865f\u3002\u652f\u6301\u7684\u97f3\u7b26\u7b26\u865f\u6709\uff1a",Object(Ke.jsxs)("p",{children:[Object(Ke.jsx)("kbd",{className:Vt.a.kbd,children:"0-7"}),Object(Ke.jsx)("kbd",{className:Vt.a.kbd,children:"\u2500 ( )"})]}),Object(Ke.jsx)("h4",{children:"\u8f38\u5165\u8f14\u52a9\u5143\u7d20"}),Object(Ke.jsxs)("ul",{className:Vt.a.list,children:[Object(Ke.jsx)(Xt,{kbd:"a",desc:"\u9078\u64c7\u9023\u7dda\u505c\u6b62\u7b26\u865f"}),Object(Ke.jsx)(Xt,{kbd:"A",desc:"\u522a\u9664\u9023\u97f3\u7dda"}),Object(Ke.jsx)(Xt,{kbd:"|",desc:"\u8f38\u5165\u5c0f\u7bc0\u7dda"}),Object(Ke.jsx)(Xt,{kbd:".",desc:"\u8f38\u5165\u9644\u52a0\u9ede"}),Object(Ke.jsx)(Xt,{kbd:"~",desc:"\u97f3\u7b26\u865f"}),Object(Ke.jsx)(Xt,{kbd:"u / U",desc:"\u589e\u52a0\u6e1b\u5c11\u6642\u9593\u7dda"}),Object(Ke.jsx)(Xt,{kbd:"!",desc:"\u6253\u65b7\u589e\u52a0\u6642\u9593\u7dda"}),Object(Ke.jsx)(Xt,{kbd:"8 / *",desc:"\u516b\u5ea6\u5713\u9ede"}),Object(Ke.jsx)(Xt,{kbd:"# / b",desc:"\u97f3\u6a19\u5347/\u964d"})]}),Object(Ke.jsx)("h4",{children:"\u64cd\u4f5c"}),Object(Ke.jsxs)("ul",{className:Vt.a.list,children:[Object(Ke.jsx)(Xt,{kbd:"Enter",desc:"\u4e0b\u4e00\u500b\u97f3\u7b26"}),Object(Ke.jsx)(Xt,{kbd:"Shift+Enter",desc:"\u4e0a\u4e00\u500b\u97f3\u7b26"}),Object(Ke.jsx)(Xt,{kbd:r+"+Enter",desc:"\u63d2\u5165\u97f3\u7b26"}),Object(Ke.jsx)(Xt,{kbd:"Delete",desc:"\u522a\u9664\u97f3\u7b26"}),Object(Ke.jsx)(Xt,{kbd:"Shift+Delete",desc:"\u522a\u9664\u6bb5\u843d"}),Object(Ke.jsx)(Xt,{kbd:"=",desc:"\u6bb5\u843d\u662f\u5426\u5169\u7aef\u5c0d\u9f4a"}),Object(Ke.jsx)(Xt,{kbd:r+"+C",desc:"\u8907\u88fd\u97f3\u7b26"}),Object(Ke.jsx)(Xt,{kbd:r+"+Shift+C",desc:"\u8907\u88fd\u6bb5\u843d"}),Object(Ke.jsx)(Xt,{kbd:r+"+V",desc:"\u8cbc\u4e0a"})]}),Object(Ke.jsx)("h2",{children:"\u63d0\u793a"}),Object(Ke.jsxs)("ul",{className:Vt.a.list,children:[Object(Ke.jsx)("li",{children:"\u6bb5\u843d\u4e0a\u53ef\u4ee5\u53f3\u9375\u5f48\u51fa\u64cd\u4f5c\u83dc\u55ae"}),Object(Ke.jsx)("li",{children:"\u589e\u52a0\u6642\u9593\u7dda\u9ed8\u8a8d\u9023\u63a5\uff0c\u53ef\u5728\u97f3\u7b26\u53f3\u9375\u83dc\u55ae\u4e2d\u9078\u64c7\u6253\u65b7"})]})]})},Jt=["C","D","E","F","G","A","B","\u266dC","\u266dD","\u266dE","\u266dF","\u266dG","\u266dA","\u266dB"].map((function(e){return{key:e,text:e}}));var Rt=Object(p.a)((function(e){var t=e.key,n=e.showndata;void 0==Z.tonedata[t]&&(Z.tonedata[t]="C",Z.beatdata[t]=[4,4],Z.speeddata[t]="75");var a=[];return n.includes(0)&&a.push(Object(Ke.jsx)(Ot,{inputType:"select",initialValue:Z.tonedata[t],options:Jt,onChange:function(e){Z.tonedata[t]=e},popoverProps:{trigger:"click"},children:Object(Ke.jsxs)(yt,{type:"tone",editable:!0,offsetX:0,offsetY:0,children:[Object(Ke.jsx)(Ct,{children:"1 = "}),Z.tonedata[t].startsWith("\u266d")&&Object(Ke.jsx)(Ct,{x:"27",y:"-2",fontSize:Z.defaultSubFontSize,children:"\u266d"}),Object(Ke.jsx)(Ct,{editable:!0,x:Z.tonedata[t].startsWith("\u266d")?36:29,children:Z.tonedata[t].at(-1)})]})})),n.includes(1)&&a.push(Object(Ke.jsx)(Ot,{title:"\u7bc0\u62cd\uff1a",inputType:"number",initialValue:Z.beatdata[t].join("/"),onChange:function(e){var n=String(e).split("/");if(2!==n.length)return w.a.error("\u8acb\u4ee5\u3010*/*\u3011\u7684\u683c\u5f0f\u8f38\u5165\u7bc0\u62cd\uff01"),!1;var a=[parseInt(n[0],10),parseInt(n[1],10)],r=a[0],i=a[1];if(!(r>0&&i>0))return w.a.error("\u8acb\u8f38\u5165\u5927\u65bc0\u7684\u62cd\u6578\u548c\u6642\u503c\uff01"),!1;Z.beatdata[t]=[r,i]},children:Object(Ke.jsxs)(yt,{type:"beat",editable:!0,offsetX:n.includes(0)?64:6,offsetY:0,children:[Object(Ke.jsx)(Ct,{x:"0",y:"-8",textAnchor:"middle",children:Z.beatdata[t][0]}),Object(Ke.jsx)(Ct,{x:"0",y:"12",textAnchor:"middle",children:Z.beatdata[t][1]}),Object(Ke.jsx)("line",{x1:"-8",y1:"8",x2:"8",y2:"8",stroke:"currentColor"})]})})),n.includes(2)&&a.push(Object(Ke.jsx)(Ot,{title:"\u901f\u5ea6\uff08bps\uff09\uff1a",inputType:"number",initialValue:Z.speeddata[t],onChange:function(e){Z.speeddata[t]=e},children:Object(Ke.jsxs)(yt,{editable:!0,type:"speed",offsetX:n.includes(0)?50:n.includes(1)?22:0,offsetY:n.includes(0)&&n.includes(1)?22:0,children:[Object(Ke.jsx)(Ct,{x:"2",children:"\u2669"}),Object(Ke.jsxs)(Ct,{x:"16",children:["= ",Z.speeddata[t]]})]})})),console.log(a),console.log(n.toString()),Object(Ke.jsx)(Ke.Fragment,{children:a})})),Ut=n(171);function Gt(e){var t=k((function(t){switch(t.key){case"add":var n=Z.paragraphs.findIndex((function(t){return t.key===e.key})),a=D({notations:[M({note:"0"}),M({note:"0"}),M({note:"0"}),M({note:T})]});-1!==n?Z.paragraphs.splice(n+1,0,a):Z.paragraphs.push(a);break;case"addz":var r=[];l.a.info({title:"\u6dfb\u52a0\u6ed1\u97f3\u7b26\u865f(BETA)",content:Object(Ke.jsxs)(me.a.Group,{onChange:function(e){r=e},children:[Object(Ke.jsx)(me.a,{value:0,children:"\u8abf\u5b50"}),Object(Ke.jsx)(me.a,{value:1,children:"\u7bc0\u62cd"}),Object(Ke.jsx)(me.a,{value:2,children:"\u901f\u5ea6"})]}),onOk:function(){if(0==r.length)l.a.error({title:"\u932f\u8aa4",content:"\u6c92\u6709\u9078\u64c7\u6ed1\u97f3\u7b26\u865f"});else{var e=D({notations:[K({showndata:r})]});Z.paragraphs.push(e)}}});break;case"delete":var i=Z.paragraphs.findIndex((function(t){return t.key===e.key}));-1!==i&&Z.paragraphs.splice(i,1)}}));return Object(Ke.jsxs)(ye.a,{onClick:t,children:[Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(Ut.a,{}),children:"\u6dfb\u52a0\u6bb5\u843d"},"add"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(Ut.a,{}),children:"\u6dfb\u52a0\u6ed1\u97f3\u7b26\u865f (BETA)"},"addz"),Object(Ke.jsx)(ye.a.Item,{danger:!0,icon:Object(Ke.jsx)(_t.a,{}),children:"\u522a\u9664\u6bb5\u843d"},"delete")]})}var $t=n(172),Qt=n(173),Zt=function(e,t){var n=e.tieTo,a=k((function(t){var a=t.key;switch(!0){case"tie"===a:if(!n)return void(x.tieSourceKey=e.key);var r=V(e.tieTo).notation;r&&(r.tieTo=null),e.tieTo=null;break;case"break-underline"===a:e.breakUnderline=!e.breakUnderline;break;case a.startsWith("separator-"):var i=a.split("-",2)[1];e.note=i}}));return Object(Ke.jsxs)(ye.a,{onClick:a,style:{minWidth:"80px"},mode:"vertical",children:[W(e)&&Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)($t.a,{}),children:e.breakUnderline?"\u5728\u6b64\u8655\u5ef6\u7e8c\u589e\u6e1b\u6642\u7dda":"\u5728\u6b64\u8655\u6253\u65b7\u589e\u6e1b\u6642\u7dda"},"break-underline"),W(e)&&Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(Qt.a,{}),notation:e,children:e.tieTo?"\u522a\u9664\u8fde\u97f3\u7ebf":"\u5f9e\u6b64\u8655\u6dfb\u52a0\u9023\u97f3\u7dda\u5230..."},"tie"),Object(Ke.jsx)(ye.a.Item,{icon:Object(Ke.jsx)(_t.a,{}),children:"\u522a\u9664\u7b26\u865f"},"delete")]})};var qt=n(132),en=n.n(qt);function tn(e){var t=e.offsetX,n=e.notation,a=(e.paragraph,k((function(){x.selectedNotationKey=n.key,x.shouldNotationBlurAfterClick=!1,B(n)}))),r=de.underlineStepOffsetY*(0|n.underline),i=n.octave>0?-de.octaveInitialOffsetAbove:de.octaveInitialOffsetBelow+r,o=(n.octave>0?-1:1)*de.octaveStepOffsetY,c=0;n.octave>0&&(c=o*Math.abs(n.octave));return Object(Ke.jsx)(Ot,{inputType:"select",popoverProps:{trigger:"context"},overlay:Zt(n),children:Object(Ke.jsxs)(yt,{editable:!0,type:"notation",offsetX:t,onClick:a,className:x.selectedNotationKey===n.key?en.a.selectedNotation:"",children:[function(){var e=n.prefixSups||[];return e.map((function(t,n){return Object(Ke.jsx)(Ct,{dominantBaseline:"middle",textAnchor:"middle",fontSize:Z.defaultSubFontSize,x:-de.xWidth-(ie(e.slice(0,n).join(""))+2*n),y:-de.subXHeight/2+2,children:t},n+t)}))}(),(n.topDecorators||[]).map((function(e,t){return Object(Ke.jsx)(Ct,{dominantBaseline:"middle",textAnchor:"middle",fontSize:Z.defaultSubFontSize,y:c-(t+1)*de.subXHeight+2,children:e},t+e)})),function(){var e;return n.note===I&&(e="scale(0.8, 1)"),Object(Ke.jsx)(Ct,{dominantBaseline:"middle",textAnchor:"middle",transform:e,children:n.note})}(),n.dotted&&Object(Ke.jsx)("circle",{type:"dot",cx:de.xWidth+4,cy:"-2",r:"2",fill:"currentColor"}),function(e){var t=Math.abs(Number(e));return Number.isInteger(t)?Array(t).fill(0,0,t):[]}(n.octave).map((function(e,t){return Object(Ke.jsx)("circle",{type:"octave",cx:"0",cy:i+o*t,fill:"currentColor",r:"2"},t)}))]})})}tn.defaultProps={offsetX:0,offsetY:0};var nn=Object(p.a)(tn);var an=Object(p.a)((function(e){var t,n=e.paragraph,a=e.offsetY,r=e.alignJustify,i=n.notations||[],o=[],c=0;if(r&&(null===(t=n.notations)||void 0===t?void 0:t.length)>1){var s=function(e){var t=e.notations||[];return 0===t.length?0:t.map((function(e){return ue(e)})).reduce((function(e,t){return e+t}),0)-Z.gapBetweenNotation}(n);c=(de.maxContentWidth-s)/(n.notations.length-1)}var l=i.map((function(e,t){return de.xWidth/2+function(e){for(var t=0,n=0;n<e;n++){var a=i[n];o[n]=o[n]||ue(a),t+=o[n]}return t+se(i[e])}(t)+c*t})),u=function(e,t,n){return Object(Ke.jsx)("line",{x1:l[t]-de.xWidth,x2:l[n]+de.xWidth,y1:e,y2:e,stroke:"currentColor"},"".concat(t,"_").concat(n,"_").concat(e))},d=function(){var e=oe(n);return Object(Ke.jsx)(Ot,{inputType:"select",overlay:Gt(n),children:Object(Ke.jsx)("rect",{x:-de.xWidth/2,y:-ce(n),width:de.maxContentWidth,height:e,fill:"transparent"})})};return"beatsp"===i[0].type?(Z.tonedata[i[0].key]="C",Object(Ke.jsxs)(yt,{type:"paragraph",offsetY:a-20,children:[d(),Object(Ke.jsx)(Rt,{showndata:i[0].showndata},i[0].key)]})):Object(Ke.jsxs)(yt,{type:"paragraph",offsetY:a,children:[d(),function(){for(var e=[],t=new Map,n=function(n){var a=i[n];if(a.tieTo){var r=i.findIndex((function(e){return e.key===a.tieTo}));if(r<=n)return"continue";for(var o=0,c=n;c<=r;++c){var s=void 0;t.has(i[c].key)?s=t.get(i[c].key):(s=-le(i[c]),t.set(i[c].key,s)),o=Math.min(o,s)}e.push(function(e,t,n){var a=l[t],r=a+4,i=l[n],o=i-4,c=i-a,s=21917145491103032e-21*c*c*c-.0062948773732605465*c*c+.6378785891964498*c-.6843414475200537,u=e-(s=Math.max(Math.min(s,de.maxTieBezierOffset),de.minTieHeight));return Object(Ke.jsx)("path",{d:"M".concat(a," ").concat(e," C").concat(r," ").concat(u," ").concat(o," ").concat(u," ").concat(i," ").concat(e),stroke:"currentColor",fill:"none"},"".concat(t,"_").concat(n,"_").concat(e))}(o,n,r))}},a=0;a<i.length;++a)n(a);return e}(),n.notations.map((function(e,t){return Object(Ke.jsx)(nn,{notation:e,paragraph:n,offsetX:l[t]},e.key)})),function(){for(var e=[],t=i.map((function(e){return e.underline>0?e.underline:0})),n=de.underlineInitialOffsetY;t.some((function(e){return e>0}));){for(var a=-1,r=a,o=0;o<i.length;++o){var c=i[o];t[o]>0?(a>=0?c.breakUnderline?(e.push(u(n,a,r)),a=r=o):r=o:a=r=o,o===i.length-1&&(e.push(u(n,a,r)),a=r=-1),--t[o]):a>=0&&(e.push(u(n,a,r)),a=r=-1)}n+=de.underlineStepOffsetY}return e}()]})})),rn=n(115),on=n.n(rn);var cn=Object(p.a)((function(){var e=[];function t(t){for(var n=Z.paragraphs||[],a=0,r=0;r<t;r++){var i=n[r];e[r]=e[r]||oe(i)+Z.gapBetweenParagraph,a+=e[r]}return a+=ce(n[t])}var n=S((function(e){x.configDialogVisible=e})),r=S((function(e){x.helpDialogVisible=e}));return Object(a.useEffect)((function(){return document.addEventListener("keydown",Xe),function(){document.removeEventListener("keydown",Xe)}}),[]),Object(Ke.jsxs)("div",{className:on.a.container,style:{width:Z.canvasWidth+"px"},children:[Object(Ke.jsx)("div",{style:{},className:on.a.headerWrapper,children:Object(Ke.jsxs)("div",{className:on.a.header,style:{width:Z.canvasWidth+"px"},children:[Object(Ke.jsx)(c.a,{overlay:Le,placement:"bottomLeft",children:Object(Ke.jsx)(s.a,{icon:Object(Ke.jsx)(u.a,{}),type:"text",children:"\u6a94\u6848"})}),Object(Ke.jsx)(c.a,{overlay:Je,placement:"bottomLeft",children:Object(Ke.jsx)(s.a,{icon:Object(Ke.jsx)(d.a,{}),type:"text",children:"\u7de8\u8f2f"})}),Object(Ke.jsx)(s.a,{icon:Object(Ke.jsx)(h.a,{}),type:"text",onClick:function(){n(!0)},children:"\u8a2d\u7f6e"}),Object(Ke.jsx)(s.a,{icon:Object(Ke.jsx)(b.a,{}),type:"text",onClick:function(){r(!0)},children:"\u5feb\u6377\u9375"}),Object(Ke.jsx)(s.a,{icon:Object(Ke.jsx)(f.a,{}),type:"text",onClick:function(){l.a.info({title:"\u95dc\u65bc EasyType",content:Object(Ke.jsxs)("div",{children:[Object(Ke.jsxs)("p",{children:["EasyType \u7248\u672c: ","1.5.0","(",3,")"]}),Object(Ke.jsx)("p",{children:"Copyright (c) 2022, Meow Tech Open Source. Based on Numerical Notation Editor, licensed under GNU v3 public license."})]}),onOk:function(){}})},children:"\u95dc\u65bc"})]})}),Object(Ke.jsxs)(Ze,{onClick:Ve,children:[Object(Ke.jsx)(zt,{}),Object(Ke.jsx)(yt,{offsetX:Z.marginHorizontal,offsetY:1==Z.showheaders?de.headerOffsetY:de.headerOffsetY-60,children:Z.paragraphs.map((function(e,n){var a=e.alignJustify;return"boolean"!==typeof a&&(a=!(n===Z.paragraphs.length-1)),Object(Ke.jsx)(an,{paragraph:e,offsetY:t(n),alignJustify:a},e.key)}))})]}),Object(Ke.jsx)(ot,{visible:x.configDialogVisible,onVisibleChange:n}),Object(Ke.jsx)(Lt,{visible:x.helpDialogVisible,onVisibleChange:r})]})}));function sn(){return(sn=Object(He.a)(Ee.a.mark((function e(){var t;return Ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!/(\?|&)loadExample(&|$)/.test(window.location.search)){e.next=6;break}return e.next=4,n.e(4).then(n.t.bind(null,179,3));case 4:t=e.sent,G(t.default);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Z.tonedata={},Z.beatdata={},Z.speeddata={},Z.page=1;var ln=function(){return Object(a.useEffect)((function(){!function(){sn.apply(this,arguments)}()}),[]),Object(Ke.jsx)(Q.Provider,{value:Z,children:Object(Ke.jsx)(cn,{})})},un=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,180)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),i(e),o(e)}))};n(149);o.a.render(Object(Ke.jsx)(r.a.StrictMode,{children:Object(Ke.jsx)(ln,{})}),document.getElementById("root")),un()},60:function(e,t,n){e.exports={list:"HelpModal_list__jvqd7",listItem:"HelpModal_listItem__1LT1r",kbd:"HelpModal_kbd__10-uc"}},90:function(e,t,n){e.exports={popover:"PopoverOnSvg_popover__34WrV",arrow:"PopoverOnSvg_arrow__3TVPU",content:"PopoverOnSvg_content__diMkp",header:"PopoverOnSvg_header__1LkMw"}},91:function(e,t,n){e.exports={buttonGroup:"EditableContent_buttonGroup__3CYtX",button:"EditableContent_button__38O1R",menu:"EditableContent_menu__1dXQb",menuItem:"EditableContent_menuItem__2D_1f"}}},[[150,1,2]]]);
//# sourceMappingURL=main.636bb353.chunk.js.map